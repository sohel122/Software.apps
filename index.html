<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieVerse - Stream Movies Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #121212;
            --bg-secondary: #181818;
            --bg-card: #252525;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --accent: #e50914;
            --accent-hover: #f40612;
            --border: #333333;
            --success: #46d369;
            --error: #e87c03;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Splash Screen with Ad */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-primary);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
        }

        .splash-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .ad-container {
            width: 100%;
            max-width: 800px;
            height: 400px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }

        .ad-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .ad-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 15px;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ad-text {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .ad-skip {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .ad-skip:hover {
            background-color: var(--accent-hover);
        }

        .ad-skip:disabled {
            background-color: var(--border);
            cursor: not-allowed;
        }

        .splash-logo {
            font-size: 36px;
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .splash-text {
            color: var(--text-secondary);
            font-size: 18px;
        }

        /* Header */
        .header {
            background-color: var(--bg-secondary);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
            color: var(--accent);
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            margin: 0 20px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            background-color: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 8px;
            cursor: pointer;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .theme-toggle:hover {
            color: var(--accent);
        }

        /* Main Content */
        .main-content {
            padding-bottom: 70px; /* Space for bottom nav */
        }

        /* Promotion Slider */
        .promo-slider {
            position: relative;
            width: 100%;
            height: 300px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .promo-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .promo-slide.active {
            opacity: 1;
        }

        .promo-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .promo-slide a {
            display: block;
            width: 100%;
            height: 100%;
        }

        .slider-dots {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }

        .slider-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .slider-dot.active {
            background-color: var(--accent);
        }

        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 0 20px;
        }

        .section-title {
            font-size: 22px;
            font-weight: 600;
        }

        .see-all {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.2s;
        }

        .see-all:hover {
            color: var(--accent);
        }

        /* Movie Grid */
        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            padding: 0 20px;
            margin-bottom: 30px;
        }

        .movie-card {
            position: relative;
            border-radius: 6px;
            overflow: hidden;
            transition: transform 0.2s;
            cursor: pointer;
        }

        .movie-card:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        .movie-poster {
            width: 100%;
            height: 225px;
            object-fit: cover;
        }

        .movie-info {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 10px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .movie-card:hover .movie-info {
            opacity: 1;
        }

        .movie-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .movie-category {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .movie-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .movie-btn {
            background-color: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .movie-btn:hover {
            background-color: var(--accent);
        }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: 10px;
            padding: 0 20px;
            margin-bottom: 20px;
            overflow-x: auto;
            scrollbar-width: none; /* Firefox */
        }

        .filter-bar::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }

        .filter-chip {
            padding: 8px 15px;
            background-color: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-chip.active {
            background-color: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* Movie Details Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--bg-card);
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            position: relative;
            height: 300px;
            overflow: hidden;
        }

        .modal-header img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .modal-close:hover {
            background-color: var(--accent);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .modal-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .modal-description {
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--accent-hover);
        }

        .btn-secondary {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background-color: var(--border);
        }

        /* Video Player */
        .video-player-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            display: none;
            flex-direction: column;
        }

        .video-player-container.active {
            display: flex;
        }

        .video-player-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--bg-secondary);
        }

        .video-player-title {
            font-size: 18px;
            font-weight: 600;
        }

        .video-player-close {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
        }

        .video-player-content {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .video-player {
            width: 100%;
            max-width: 900px;
            aspect-ratio: 16/9;
            background-color: black;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .video-player video,
        .video-player iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Ad Container in Video Player */
        .video-ad-container {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 10;
        }

        .video-ad-content {
            width: 100%;
            max-width: 728px;
            max-height: 90px;
        }

        .video-ad-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            cursor: pointer;
            z-index: 11;
        }

        .video-ad-timer {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 11;
        }

        /* Video Controls */
        .video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 10px;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 5;
        }

        .video-controls-left, .video-controls-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .video-control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .video-control-btn:hover {
            color: var(--accent);
        }

        .video-progress {
            width: 100%;
            height: 4px;
            background-color: rgba(255, 255, 255, 0.3);
            margin: 10px 0;
            cursor: pointer;
            position: relative;
        }

        .video-progress-filled {
            height: 100%;
            background-color: var(--accent);
            width: 0%;
        }

        /* Profile Page */
        .page {
            display: none;
            padding: 20px;
        }

        .page.active {
            display: block;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--bg-card);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: var(--text-secondary);
        }

        .profile-info h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .profile-info p {
            color: var(--text-secondary);
        }

        .profile-section {
            background-color: var(--bg-card);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .profile-section h3 {
            font-size: 18px;
            margin-bottom: 15px;
        }

        .watched-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }

        .watched-item {
            position: relative;
            border-radius: 6px;
            overflow: hidden;
        }

        .watched-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .watched-item-title {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 8px;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .profile-action-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.2s;
        }

        .profile-action-btn:hover {
            background-color: var(--border);
        }

        .profile-action-btn i {
            width: 24px;
            text-align: center;
            color: var(--accent);
        }

        /* Settings Page */
        .settings-section {
            background-color: var(--bg-card);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .settings-section h3 {
            font-size: 18px;
            margin-bottom: 15px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .setting-title {
            font-weight: 500;
        }

        .setting-description {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: 0.3s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--accent);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Language Selector */
        .language-selector {
            padding: 8px 15px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 16px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--bg-secondary);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 12px;
            transition: color 0.2s;
            cursor: pointer;
        }

        .nav-item.active {
            color: var(--accent);
        }

        .nav-item i {
            font-size: 20px;
        }

        /* No Results Message */
        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .no-results i {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 40px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
            }

            .logo {
                font-size: 20px;
            }

            .search-container {
                margin: 0 10px;
            }

            .promo-slider {
                height: 200px;
            }

            .movie-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 10px;
                padding: 0 15px;
            }

            .movie-poster {
                height: 180px;
            }

            .modal-content {
                max-width: 100%;
            }

            .modal-header {
                height: 200px;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Light Theme */
        body.light-theme {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --text-primary: #333333;
            --text-secondary: #757575;
            --border: #e0e0e0;
        }

        body.light-theme .modal-header {
            background-color: #f0f0f0;
        }

        body.light-theme .video-player-header {
            background-color: #ffffff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <!-- Splash Screen with Ad -->
    <div class="splash-screen" id="splashScreen">
        <div class="ad-container" id="adContainer">
            <!-- Ad will be loaded here -->
        </div>
        <div class="splash-logo">
            <i class="fas fa-film"></i> MovieVerse
        </div>
        <div class="splash-text">Your entertainment destination</div>
        <button class="ad-skip" id="skipAdBtn" disabled>Skip (5)</button>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-film"></i>
            <span>MovieVerse</span>
        </div>
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Search for movies...">
            <button class="search-btn" id="searchBtn">
                <i class="fas fa-search"></i>
            </button>
        </div>
        <div class="user-menu">
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Page -->
        <div class="page active" id="homePage">
            <!-- Promotion Slider -->
            <div class="promo-slider" id="promoSlider">
                <!-- Promotional banners will be loaded here -->
                <div class="slider-dots" id="sliderDots">
                    <!-- Slider dots will be loaded here -->
                </div>
            </div>

            <!-- Filter Bar -->
            <div class="filter-bar" id="filterBar">
                <div class="filter-chip active" data-filter="all">All</div>
                <div class="filter-chip" data-filter="trending">Trending</div>
                <div class="filter-chip" data-filter="new">New Releases</div>
                <div class="filter-chip" data-filter="action">Action</div>
                <div class="filter-chip" data-filter="comedy">Comedy</div>
                <div class="filter-chip" data-filter="drama">Drama</div>
                <div class="filter-chip" data-filter="horror">Horror</div>
                <div class="filter-chip" data-filter="romance">Romance</div>
                <div class="filter-chip" data-filter="sci-fi">Sci-Fi</div>
                <div class="filter-chip" data-filter="thriller">Thriller</div>
            </div>

            <!-- Trending Now Section -->
            <div class="section-header">
                <h2 class="section-title">Trending Now</h2>
                <a href="#" class="see-all">See All</a>
            </div>
            <div class="movie-grid" id="trendingMovies">
                <!-- Trending movies will be loaded here -->
            </div>

            <!-- New Releases Section -->
            <div class="section-header">
                <h2 class="section-title">New Releases</h2>
                <a href="#" class="see-all">See All</a>
            </div>
            <div class="movie-grid" id="newMovies">
                <!-- New movies will be loaded here -->
            </div>

            <!-- Categories Section -->
            <div class="section-header">
                <h2 class="section-title">Browse by Category</h2>
            </div>
            <div class="movie-grid" id="categoryMovies">
                <!-- Movies by category will be loaded here -->
            </div>
        </div>

        <!-- Search Page -->
        <div class="page" id="searchPage">
            <div class="section-header">
                <h2 class="section-title">Search Results</h2>
            </div>
            <div class="movie-grid" id="searchResults">
                <!-- Search results will be loaded here -->
            </div>
            <div class="no-results" id="noResults" style="display: none;">
                <i class="fas fa-search"></i>
                <p>No movies found. Try a different search term.</p>
            </div>
        </div>

        <!-- Profile Page -->
        <div class="page" id="profilePage">
            <div class="profile-header">
                <div class="profile-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="profile-info">
                    <h2>Guest User</h2>
                    <p>Enjoying movies as a guest</p>
                </div>
            </div>

            <div class="profile-section">
                <h3>Recently Watched</h3>
                <div class="watched-list" id="watchedList">
                    <!-- Watched movies will be loaded here -->
                </div>
                <div class="no-results" id="noWatched" style="display: none;">
                    <i class="fas fa-film"></i>
                    <p>You haven't watched any movies yet.</p>
                </div>
            </div>

            <div class="profile-section">
                <h3>Account</h3>
                <div class="profile-actions">
                    <a href="#" class="profile-action-btn">
                        <i class="fas fa-info-circle"></i>
                        <span>About App</span>
                    </a>
                    <a href="#" class="profile-action-btn">
                        <i class="fas fa-star"></i>
                        <span>Rate Us</span>
                    </a>
                    <a href="#" class="profile-action-btn">
                        <i class="fas fa-headset"></i>
                        <span>Support</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div class="page" id="settingsPage">
            <div class="settings-section">
                <h3>Appearance</h3>
                <div class="setting-item">
                    <div class="setting-label">
                        <span class="setting-title">Theme</span>
                        <span class="setting-description">Choose between light and dark theme</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="settingsThemeToggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h3>Preferences</h3>
                <div class="setting-item">
                    <div class="setting-label">
                        <span class="setting-title">Language</span>
                        <span class="setting-description">Select your preferred language</span>
                    </div>
                    <select class="language-selector" id="languageSelector">
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="ja">Japanese</option>
                        <option value="zh">Chinese</option>
                    </select>
                </div>
                <div class="setting-item">
                    <div class="setting-label">
                        <span class="setting-title">Notifications</span>
                        <span class="setting-description">Receive notifications about new movies</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notificationsToggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h3>Data & Storage</h3>
                <div class="setting-item">
                    <div class="setting-label">
                        <span class="setting-title">Clear Watch History</span>
                        <span class="setting-description">Remove all movies from your watch history</span>
                    </div>
                    <button class="btn btn-secondary" id="clearHistoryBtn">Clear</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a class="nav-item active" data-page="homePage">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </a>
        <a class="nav-item" data-page="searchPage">
            <i class="fas fa-search"></i>
            <span>Search</span>
        </a>
        <a class="nav-item" data-page="profilePage">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </a>
        <a class="nav-item" data-page="settingsPage">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
        </a>
    </nav>

    <!-- Movie Details Modal -->
    <div class="modal" id="movieDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <img src="" alt="Movie Poster" id="modalPoster">
                <button class="modal-close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <h2 class="modal-title" id="modalTitle"></h2>
                <div class="modal-meta">
                    <span id="modalCategory"></span>
                    <span id="modalLanguage"></span>
                    <span id="modalYear"></span>
                </div>
                <p class="modal-description" id="modalDescription"></p>
                <div class="modal-actions">
                    <button class="btn btn-primary" id="watchNowBtn">
                        <i class="fas fa-play"></i>
                        Watch Now
                    </button>
                    <button class="btn btn-secondary" id="shareBtn">
                        <i class="fas fa-share"></i>
                        Share
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Player -->
    <div class="video-player-container" id="videoPlayerContainer">
        <div class="video-player-header">
            <div class="video-player-title" id="videoPlayerTitle"></div>
            <button class="video-player-close" id="closeVideoPlayer">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="video-player-content">
            <div class="video-player" id="videoPlayer">
                <!-- Video player will be loaded here -->
                <!-- Ad container will be added dynamically -->
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCKUZpW-Cb1WdhJ4uQR_U1Q4xA3rX_31r0",
            authDomain: "movie-box-ai.firebaseapp.com",
            databaseURL: "https://movie-box-ai-default-rtdb.firebaseio.com",
            projectId: "movie-box-ai",
            storageBucket: "movie-box-ai.firebasestorage.app",
            messagingSenderId: "652765395945",
            appId: "1:652765395945:web:28ece5546fee5ff8a46978"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // DOM Elements
        const splashScreen = document.getElementById('splashScreen');
        const adContainer = document.getElementById('adContainer');
        const skipAdBtn = document.getElementById('skipAdBtn');
        const themeToggle = document.getElementById('themeToggle');
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const navItems = document.querySelectorAll('.nav-item');
        const pages = document.querySelectorAll('.page');
        const filterChips = document.querySelectorAll('.filter-chip');
        const movieDetailsModal = document.getElementById('movieDetailsModal');
        const videoPlayerContainer = document.getElementById('videoPlayerContainer');
        const closeModal = document.getElementById('closeModal');
        const closeVideoPlayer = document.getElementById('closeVideoPlayer');
        const watchNowBtn = document.getElementById('watchNowBtn');
        const shareBtn = document.getElementById('shareBtn');
        const settingsThemeToggle = document.getElementById('settingsThemeToggle');
        const languageSelector = document.getElementById('languageSelector');
        const notificationsToggle = document.getElementById('notificationsToggle');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');

        // App State
        let movies = [];
        let promotions = [];
        let adsterraAds = [];
        let currentFilter = 'all';
        let currentMovie = null;
        let sliderInterval = null;
        let currentSlide = 0;
        let adTimer = null;
        let adCountdown = 5;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Load theme from localStorage
            const savedTheme = localStorage.getItem('movieverse_user_theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                settingsThemeToggle.checked = true;
            }

            // Load language from localStorage
            const savedLanguage = localStorage.getItem('movieverse_language');
            if (savedLanguage) {
                languageSelector.value = savedLanguage;
            }

            // Load notifications setting from localStorage
            const notificationsEnabled = localStorage.getItem('movieverse_notifications');
            if (notificationsEnabled === 'false') {
                notificationsToggle.checked = false;
            }

            // Load data from Firebase
            loadMovies();
            loadPromotions();
            loadAdsterraAds();
            loadWatchHistory();

            // Start splash screen with ad
            startSplashScreen();
        });

        // Splash Screen with Ad
        function startSplashScreen() {
            // Check if ad system is enabled
            const adSystemEnabled = localStorage.getItem('movieverse_ad_system');
            
            if (adSystemEnabled === 'false') {
                // Skip ad if system is disabled
                setTimeout(() => {
                    splashScreen.classList.add('hidden');
                }, 1000);
                return;
            }

            // Load promotion for ad
            db.ref('promotions').once('value')
                .then(snapshot => {
                    const promotionsData = snapshot.val();
                    if (!promotionsData) {
                        // No promotions, skip ad
                        setTimeout(() => {
                            splashScreen.classList.add('hidden');
                        }, 1000);
                        return;
                    }

                    // Find active promotion
                    let activePromotion = null;
                    for (const id in promotionsData) {
                        if (promotionsData[id].status) {
                            activePromotion = promotionsData[id];
                            break;
                        }
                    }

                    if (!activePromotion) {
                        // No active promotion, skip ad
                        setTimeout(() => {
                            splashScreen.classList.add('hidden');
                        }, 1000);
                        return;
                    }

                    // Display ad
                    adContainer.innerHTML = `
                        <a href="${activePromotion.link}" target="_blank">
                            <img src="${activePromotion.image}" alt="Advertisement">
                        </a>
                        <div class="ad-overlay">
                            <div class="ad-text">Advertisement</div>
                            <button class="ad-skip" id="skipAdBtn" disabled>Skip (5)</button>
                        </div>
                    `;

                    // Start countdown
                    let countdown = 5;
                    const skipBtn = document.getElementById('skipAdBtn');
                    
                    const countdownInterval = setInterval(() => {
                        countdown--;
                        skipBtn.textContent = `Skip (${countdown})`;
                        
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            skipBtn.disabled = false;
                            skipBtn.textContent = 'Skip';
                        }
                    }, 1000);

                    // Skip button click
                    skipBtn.addEventListener('click', function() {
                        clearInterval(countdownInterval);
                        splashScreen.classList.add('hidden');
                    });

                    // Auto-skip after 5 seconds
                    setTimeout(() => {
                        clearInterval(countdownInterval);
                        splashScreen.classList.add('hidden');
                    }, 5000);
                })
                .catch(error => {
                    console.error('Error loading promotions:', error);
                    // Skip ad on error
                    setTimeout(() => {
                        splashScreen.classList.add('hidden');
                    }, 1000);
                });
        }

        // Event Listeners
        themeToggle.addEventListener('click', function() {
            document.body.classList.toggle('light-theme');
            
            if (document.body.classList.contains('light-theme')) {
                this.innerHTML = '<i class="fas fa-sun"></i>';
                localStorage.setItem('movieverse_user_theme', 'light');
                settingsThemeToggle.checked = true;
            } else {
                this.innerHTML = '<i class="fas fa-moon"></i>';
                localStorage.setItem('movieverse_user_theme', 'dark');
                settingsThemeToggle.checked = false;
            }
        });

        settingsThemeToggle.addEventListener('change', function() {
            if (this.checked) {
                document.body.classList.add('light-theme');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                localStorage.setItem('movieverse_user_theme', 'light');
            } else {
                document.body.classList.remove('light-theme');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                localStorage.setItem('movieverse_user_theme', 'dark');
            }
        });

        languageSelector.addEventListener('change', function() {
            localStorage.setItem('movieverse_language', this.value);
        });

        notificationsToggle.addEventListener('change', function() {
            localStorage.setItem('movieverse_notifications', this.checked);
        });

        clearHistoryBtn.addEventListener('click', function() {
            if (confirm('Are you sure you want to clear your watch history?')) {
                localStorage.removeItem('movieverse_watch_history');
                loadWatchHistory();
            }
        });

        searchBtn.addEventListener('click', function() {
            const query = searchInput.value.trim();
            if (query) {
                searchMovies(query);
                showPage('searchPage');
            }
        });

        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const query = this.value.trim();
                if (query) {
                    searchMovies(query);
                    showPage('searchPage');
                }
            }
        });

        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.getAttribute('data-page');
                showPage(pageId);
            });
        });

        filterChips.forEach(chip => {
            chip.addEventListener('click', function() {
                // Update active filter
                filterChips.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                
                // Apply filter
                currentFilter = this.getAttribute('data-filter');
                filterMovies();
            });
        });

        closeModal.addEventListener('click', function() {
            movieDetailsModal.classList.remove('active');
        });

        closeVideoPlayer.addEventListener('click', function() {
            videoPlayerContainer.classList.remove('active');
            // Stop video
            const videoPlayer = document.getElementById('videoPlayer');
            videoPlayer.innerHTML = '';
        });

        watchNowBtn.addEventListener('click', function() {
            if (currentMovie) {
                playMovieWithAd(currentMovie.video, currentMovie.title, currentMovie.id);
                movieDetailsModal.classList.remove('active');
                
                // Add to watch history
                addToWatchHistory(currentMovie);
            }
        });

        shareBtn.addEventListener('click', function() {
            if (currentMovie) {
                // Create share text
                const shareText = `Check out "${currentMovie.title}" on MovieVerse!`;
                
                // Check if Web Share API is supported
                if (navigator.share) {
                    navigator.share({
                        title: currentMovie.title,
                        text: shareText,
                        url: window.location.href
                    })
                    .catch(error => console.log('Error sharing:', error));
                } else {
                    // Fallback: Copy to clipboard
                    const dummy = document.createElement('input');
                    document.body.appendChild(dummy);
                    dummy.value = shareText;
                    dummy.select();
                    document.execCommand('copy');
                    document.body.removeChild(dummy);
                    
                    // Show notification
                    showNotification('Link copied to clipboard!');
                }
            }
        });

        // Functions
        function loadMovies() {
            db.ref('movies').once('value')
                .then(snapshot => {
                    const moviesData = snapshot.val();
                    if (!moviesData) return;
                    
                    movies = [];
                    for (const id in moviesData) {
                        movies.push({
                            id: id,
                            ...moviesData[id]
                        });
                    }
                    
                    // Display movies
                    displayMovies();
                })
                .catch(error => {
                    console.error('Error loading movies:', error);
                });
        }

        function loadPromotions() {
            db.ref('promotions').once('value')
                .then(snapshot => {
                    const promotionsData = snapshot.val();
                    if (!promotionsData) return;
                    
                    promotions = [];
                    for (const id in promotionsData) {
                        if (promotionsData[id].status) {
                            promotions.push({
                                id: id,
                                ...promotionsData[id]
                            });
                        }
                    }
                    
                    // Display promotions
                    if (promotions.length > 0) {
                        displayPromotions();
                    }
                })
                .catch(error => {
                    console.error('Error loading promotions:', error);
                });
        }

        function loadAdsterraAds() {
            db.ref('adsterra').once('value')
                .then(snapshot => {
                    const adsData = snapshot.val();
                    if (!adsData) return;
                    
                    adsterraAds = [];
                    for (const id in adsData) {
                        if (adsData[id].status) {
                            adsterraAds.push({
                                id: id,
                                ...adsData[id]
                            });
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading Adsterra ads:', error);
                });
        }

        function displayMovies() {
            // Display trending movies
            const trendingMovies = movies.filter(movie => 
                movie.tags && movie.tags.includes('Trending')
            );
            displayMovieGrid('trendingMovies', trendingMovies);
            
            // Display new movies (for demo, we'll just show random movies)
            const newMovies = [...movies].sort(() => Math.random() - 0.5).slice(0, 10);
            displayMovieGrid('newMovies', newMovies);
            
            // Display movies by category
            displayMovieGrid('categoryMovies', movies);
        }

        function displayMovieGrid(containerId, movieList) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            if (movieList.length === 0) {
                container.innerHTML = '<div class="no-results"><i class="fas fa-film"></i><p>No movies found</p></div>';
                return;
            }
            
            movieList.forEach(movie => {
                const movieCard = document.createElement('div');
                movieCard.className = 'movie-card';
                movieCard.innerHTML = `
                    <img src="${movie.poster}" alt="${movie.title}" class="movie-poster">
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                        <div class="movie-category">${movie.category}</div>
                        <div class="movie-actions">
                            <button class="movie-btn" onclick="showMovieDetails('${movie.id}')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <button class="movie-btn" onclick="playMovieWithAd('${movie.video}', '${movie.title}', '${movie.id}')">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(movieCard);
            });
        }

        function displayPromotions() {
            const promoSlider = document.getElementById('promoSlider');
            const sliderDots = document.getElementById('sliderDots');
            
            // Clear existing slides
            const existingSlides = promoSlider.querySelectorAll('.promo-slide');
            existingSlides.forEach(slide => slide.remove());
            
            // Add promotion slides
            promotions.forEach((promo, index) => {
                const slide = document.createElement('div');
                slide.className = `promo-slide ${index === 0 ? 'active' : ''}`;
                slide.innerHTML = `
                    <a href="${promo.link}" target="_blank">
                        <img src="${promo.image}" alt="Promotion">
                    </a>
                `;
                promoSlider.insertBefore(slide, sliderDots);
                
                // Add dot
                const dot = document.createElement('div');
                dot.className = `slider-dot ${index === 0 ? 'active' : ''}`;
                dot.addEventListener('click', () => {
                    goToSlide(index);
                });
                sliderDots.appendChild(dot);
            });
            
            // Start auto-slider if there are multiple promotions
            if (promotions.length > 1) {
                startSlider();
            }
        }

        function startSlider() {
            // Clear existing interval
            if (sliderInterval) {
                clearInterval(sliderInterval);
            }
            
            // Set new interval
            sliderInterval = setInterval(() => {
                const nextSlide = (currentSlide + 1) % promotions.length;
                goToSlide(nextSlide);
            }, 5000);
        }

        function goToSlide(index) {
            const slides = document.querySelectorAll('.promo-slide');
            const dots = document.querySelectorAll('.slider-dot');
            
            // Hide current slide
            slides[currentSlide].classList.remove('active');
            dots[currentSlide].classList.remove('active');
            
            // Show new slide
            currentSlide = index;
            slides[currentSlide].classList.add('active');
            dots[currentSlide].classList.add('active');
            
            // Restart slider interval
            startSlider();
        }

        function filterMovies() {
            let filteredMovies = [...movies];
            
            if (currentFilter !== 'all') {
                if (currentFilter === 'trending') {
                    filteredMovies = movies.filter(movie => 
                        movie.tags && movie.tags.includes('Trending')
                    );
                } else if (currentFilter === 'new') {
                    // For demo, we'll just show random movies as "new"
                    filteredMovies = [...movies].sort(() => Math.random() - 0.5).slice(0, 10);
                } else {
                    // Filter by category
                    filteredMovies = movies.filter(movie => 
                        movie.category.toLowerCase() === currentFilter.toLowerCase()
                    );
                }
            }
            
            // Update all movie grids with filtered results
            displayMovieGrid('trendingMovies', filteredMovies);
            displayMovieGrid('newMovies', filteredMovies);
            displayMovieGrid('categoryMovies', filteredMovies);
        }

        function searchMovies(query) {
            const searchResults = document.getElementById('searchResults');
            const noResults = document.getElementById('noResults');
            
            searchResults.innerHTML = '';
            noResults.style.display = 'none';
            
            // Search movies by title or category
            const results = movies.filter(movie => 
                movie.title.toLowerCase().includes(query.toLowerCase()) ||
                movie.category.toLowerCase().includes(query.toLowerCase()) ||
                (movie.tags && movie.tags.some(tag => 
                    tag.toLowerCase().includes(query.toLowerCase())
                ))
            );
            
            if (results.length === 0) {
                noResults.style.display = 'block';
                return;
            }
            
            // Display search results
            results.forEach(movie => {
                const movieCard = document.createElement('div');
                movieCard.className = 'movie-card';
                movieCard.innerHTML = `
                    <img src="${movie.poster}" alt="${movie.title}" class="movie-poster">
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                        <div class="movie-category">${movie.category}</div>
                        <div class="movie-actions">
                            <button class="movie-btn" onclick="showMovieDetails('${movie.id}')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <button class="movie-btn" onclick="playMovieWithAd('${movie.video}', '${movie.title}', '${movie.id}')">
                                <i class="fas fa-play"></i>
                            </button>
                        </div>
                    </div>
                `;
                searchResults.appendChild(movieCard);
            });
        }

        function showMovieDetails(movieId) {
            const movie = movies.find(m => m.id === movieId);
            if (!movie) return;
            
            currentMovie = movie;
            
            // Update modal content
            document.getElementById('modalPoster').src = movie.poster;
            document.getElementById('modalTitle').textContent = movie.title;
            document.getElementById('modalCategory').textContent = movie.category;
            document.getElementById('modalLanguage').textContent = movie.language;
            document.getElementById('modalYear').textContent = new Date().getFullYear(); // Default to current year
            document.getElementById('modalDescription').textContent = movie.description;
            
            // Show modal
            movieDetailsModal.classList.add('active');
        }

        function playMovieWithAd(videoUrl, title, movieId) {
            const videoPlayer = document.getElementById('videoPlayer');
            const videoPlayerTitle = document.getElementById('videoPlayerTitle');
            
            videoPlayerTitle.textContent = title;
            
            // Show video player
            videoPlayerContainer.classList.add('active');
            
            // Find ads for this movie
            const movieAds = adsterraAds.filter(ad => 
                ad.status && (ad.movies.length === 0 || ad.movies.includes(movieId))
            );
            
            if (movieAds.length > 0) {
                // Show ad before video
                showVideoAd(movieAds, videoUrl, title);
            } else {
                // No ads, play video directly
                playVideo(videoUrl, title);
            }
            
            // Add to watch history
            const movie = movies.find(m => m.id === movieId);
            if (movie) {
                addToWatchHistory(movie);
            }
        }

        function showVideoAd(ads, videoUrl, title) {
            const videoPlayer = document.getElementById('videoPlayer');
            
            // Select a random ad
            const randomAd = ads[Math.floor(Math.random() * ads.length)];
            
            // Create ad container
            const adContainer = document.createElement('div');
            adContainer.className = 'video-ad-container';
            adContainer.innerHTML = `
                <div class="video-ad-content">
                    ${randomAd.code}
                </div>
                <button class="video-ad-close" id="adCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
                <div class="video-ad-timer" id="adTimer">5</div>
            `;
            
            videoPlayer.innerHTML = '';
            videoPlayer.appendChild(adContainer);
            
            // Start countdown
            adCountdown = 5;
            const adTimerElement = document.getElementById('adTimer');
            const adCloseBtn = document.getElementById('adCloseBtn');
            
            adTimer = setInterval(() => {
                adCountdown--;
                adTimerElement.textContent = adCountdown;
                
                if (adCountdown <= 0) {
                    clearInterval(adTimer);
                    adCloseBtn.disabled = false;
                    adCloseBtn.style.opacity = '1';
                }
            }, 1000);
            
            // Initially disable close button
            adCloseBtn.disabled = true;
            adCloseBtn.style.opacity = '0.5';
            
            // Close button click
            adCloseBtn.addEventListener('click', function() {
                if (adCountdown <= 0) {
                    clearInterval(adTimer);
                    playVideo(videoUrl, title);
                }
            });
        }

        function playVideo(videoUrl, title) {
            const videoPlayer = document.getElementById('videoPlayer');
            
            // Create video player with controls
            if (videoUrl.endsWith('.mp4') || videoUrl.includes('.m3u8')) {
                videoPlayer.innerHTML = `
                    <video id="videoElement" controls autoplay>
                        <source src="${videoUrl}" type="video/mp4">
                    </video>
                    <div class="video-controls">
                        <div class="video-controls-left">
                            <button class="video-control-btn" id="playPauseBtn">
                                <i class="fas fa-pause"></i>
                            </button>
                        </div>
                        <div class="video-progress" id="videoProgress">
                            <div class="video-progress-filled" id="videoProgressFilled"></div>
                        </div>
                        <div class="video-controls-right">
                            <button class="video-control-btn" id="downloadBtn">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="video-control-btn" id="shareVideoBtn">
                                <i class="fas fa-share"></i>
                            </button>
                            <button class="video-control-btn" id="fullscreenBtn">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // Add video controls functionality
                const videoElement = document.getElementById('videoElement');
                const playPauseBtn = document.getElementById('playPauseBtn');
                const videoProgress = document.getElementById('videoProgress');
                const videoProgressFilled = document.getElementById('videoProgressFilled');
                const downloadBtn = document.getElementById('downloadBtn');
                const shareVideoBtn = document.getElementById('shareVideoBtn');
                const fullscreenBtn = document.getElementById('fullscreenBtn');
                
                // Play/Pause functionality
                playPauseBtn.addEventListener('click', function() {
                    if (videoElement.paused) {
                        videoElement.play();
                        playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    } else {
                        videoElement.pause();
                        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                    }
                });
                
                // Update progress bar
                videoElement.addEventListener('timeupdate', function() {
                    const progress = (videoElement.currentTime / videoElement.duration) * 100;
                    videoProgressFilled.style.width = progress + '%';
                });
                
                // Seek functionality
                videoProgress.addEventListener('click', function(e) {
                    const rect = videoProgress.getBoundingClientRect();
                    const pos = (e.clientX - rect.left) / rect.width;
                    videoElement.currentTime = pos * videoElement.duration;
                });
                
                // Download functionality
                downloadBtn.addEventListener('click', function() {
                    const a = document.createElement('a');
                    a.href = videoUrl;
                    a.download = title + '.mp4';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    showNotification('Download started!');
                });
                
                // Share functionality
                shareVideoBtn.addEventListener('click', function() {
                    const shareText = `Check out "${title}" on MovieVerse!`;
                    
                    if (navigator.share) {
                        navigator.share({
                            title: title,
                            text: shareText,
                            url: window.location.href
                        })
                        .catch(error => console.log('Error sharing:', error));
                    } else {
                        const dummy = document.createElement('input');
                        document.body.appendChild(dummy);
                        dummy.value = shareText;
                        dummy.select();
                        document.execCommand('copy');
                        document.body.removeChild(dummy);
                        showNotification('Link copied to clipboard!');
                    }
                });
                
                // Fullscreen functionality
                fullscreenBtn.addEventListener('click', function() {
                    if (videoElement.requestFullscreen) {
                        videoElement.requestFullscreen();
                    } else if (videoElement.webkitRequestFullscreen) {
                        videoElement.webkitRequestFullscreen();
                    } else if (videoElement.msRequestFullscreen) {
                        videoElement.msRequestFullscreen();
                    }
                });
            } else {
                videoPlayer.innerHTML = `
                    <iframe src="${videoUrl}" frameborder="0" allowfullscreen></iframe>
                    <div class="video-controls">
                        <div class="video-controls-left">
                            <button class="video-control-btn" id="shareVideoBtn">
                                <i class="fas fa-share"></i>
                            </button>
                        </div>
                        <div class="video-controls-right">
                            <button class="video-control-btn" id="fullscreenBtn">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // Add share functionality for iframe
                const shareVideoBtn = document.getElementById('shareVideoBtn');
                shareVideoBtn.addEventListener('click', function() {
                    const shareText = `Check out "${title}" on MovieVerse!`;
                    
                    if (navigator.share) {
                        navigator.share({
                            title: title,
                            text: shareText,
                            url: window.location.href
                        })
                        .catch(error => console.log('Error sharing:', error));
                    } else {
                        const dummy = document.createElement('input');
                        document.body.appendChild(dummy);
                        dummy.value = shareText;
                        dummy.select();
                        document.execCommand('copy');
                        document.body.removeChild(dummy);
                        showNotification('Link copied to clipboard!');
                    }
                });
                
                // Add fullscreen functionality for iframe
                const fullscreenBtn = document.getElementById('fullscreenBtn');
                fullscreenBtn.addEventListener('click', function() {
                    const iframe = videoPlayer.querySelector('iframe');
                    if (iframe.requestFullscreen) {
                        iframe.requestFullscreen();
                    } else if (iframe.webkitRequestFullscreen) {
                        iframe.webkitRequestFullscreen();
                    } else if (iframe.msRequestFullscreen) {
                        iframe.msRequestFullscreen();
                    }
                });
            }
        }

        function showPage(pageId) {
            // Update active nav item
            navItems.forEach(item => {
                if (item.getAttribute('data-page') === pageId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // Show page
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.add('active');
                } else {
                    page.classList.remove('active');
                }
            });
        }

        function loadWatchHistory() {
            const watchHistory = JSON.parse(localStorage.getItem('movieverse_watch_history') || '[]');
            const watchedList = document.getElementById('watchedList');
            const noWatched = document.getElementById('noWatched');
            
            watchedList.innerHTML = '';
            
            if (watchHistory.length === 0) {
                noWatched.style.display = 'block';
                return;
            }
            
            noWatched.style.display = 'none';
            
            // Get unique watched movies
            const uniqueMovies = [];
            const movieIds = new Set();
            
            for (const item of watchHistory) {
                if (!movieIds.has(item.id)) {
                    movieIds.add(item.id);
                    uniqueMovies.push(item);
                }
            }
            
            // Display watched movies (limit to 10)
            uniqueMovies.slice(0, 10).forEach(movie => {
                const watchedItem = document.createElement('div');
                watchedItem.className = 'watched-item';
                watchedItem.innerHTML = `
                    <img src="${movie.poster}" alt="${movie.title}">
                    <div class="watched-item-title">${movie.title}</div>
                `;
                watchedItem.addEventListener('click', () => {
                    showMovieDetails(movie.id);
                });
                watchedList.appendChild(watchedItem);
            });
        }

        function addToWatchHistory(movie) {
            const watchHistory = JSON.parse(localStorage.getItem('movieverse_watch_history') || '[]');
            
            // Add movie to watch history
            watchHistory.unshift({
                id: movie.id,
                title: movie.title,
                poster: movie.poster,
                watchedAt: new Date().toISOString()
            });
            
            // Limit to 50 items
            if (watchHistory.length > 50) {
                watchHistory.splice(50);
            }
            
            // Save to localStorage
            localStorage.setItem('movieverse_watch_history', JSON.stringify(watchHistory));
            
            // Refresh watch history if on profile page
            if (document.getElementById('profilePage').classList.contains('active')) {
                loadWatchHistory();
            }
        }

        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 80px;
                left: 50%;
                transform: translateX(-50%);
                background-color: var(--bg-card);
                color: var(--text-primary);
                padding: 12px 20px;
                border-radius: 4px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                z-index: 1000;
                animation: slideUp 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Add animation styles
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>